UPDATE [dbo].[TestDocumentTbl]  SET [AColumn] = @AColumn, [JSON] = @JSON WHERE [Id] = @Id

CREATE TABLE ##related_tests (Reference nvarchar(400) COLLATE SQL_Latin1_General_CP1_CS_AS, ReferenceTable nvarchar(400) COLLATE SQL_Latin1_General_CP1_CS_AS)

INSERT INTO ##related_tests VALUES (@relateddocument_0, 'OtherTbl'), (@relateddocument_1, 'OtherTbl')

DELETE FROM [dbo].[RelatedDocument] WHERE [Id] = @Id
AND [RelatedDocumentId] not in (SELECT Reference FROM ##related_tests)

INSERT INTO [dbo].[RelatedDocument] ([Id], [Table], [RelatedDocumentId], [RelatedDocumentTable])
SELECT @Id, 'TestDocumentTbl', Reference, ReferenceTable FROM ##related_tests t
WHERE NOT EXISTS (SELECT null FROM [dbo].[RelatedDocument] r WHERE r.[Id] = @Id AND r.[RelatedDocumentId] = t.Reference )
INSERT INTO ##related_tests VALUES (@otherrelatedtable_0, 'OtherTbl'), (@otherrelatedtable_1, 'OtherTbl')

DELETE FROM [dbo].[OtherRelatedTable] WHERE [Id] = @Id
AND [RelatedDocumentId] not in (SELECT Reference FROM ##related_tests)

INSERT INTO [dbo].[OtherRelatedTable] ([Id], [Table], [RelatedDocumentId], [RelatedDocumentTable])
SELECT @Id, 'TestDocumentTbl', Reference, ReferenceTable FROM ##related_tests t
WHERE NOT EXISTS (SELECT null FROM [dbo].[OtherRelatedTable] r WHERE r.[Id] = @Id AND r.[RelatedDocumentId] = t.Reference )

@Id=Doc-1
@JSON={}
@AColumn=Doc1
@relateddocument_0=Rel-1
@relateddocument_1=Rel-2
@otherrelatedtable_0=Rel-3-Other
@otherrelatedtable_1=Rel-2