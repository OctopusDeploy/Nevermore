SELECT ROW_NUMBER() OVER (PARTITION BY [Region], [Area] ORDER BY [Foo]) AS ROWNUM FROM dbo.[Orders] ORDER BY [Id]