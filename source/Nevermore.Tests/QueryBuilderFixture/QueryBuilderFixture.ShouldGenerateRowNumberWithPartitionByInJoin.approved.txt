SELECT ROW_NUMBER() OVER (PARTITION BY t2.[Region], t2.[Area] ORDER BY t2.[Foo]) AS ROWNUM FROM dbo.[Orders] t2
INNER JOIN dbo.[Account] t1 ON t2.[AccountId] = t1.[Id] ORDER BY t2.[Id]